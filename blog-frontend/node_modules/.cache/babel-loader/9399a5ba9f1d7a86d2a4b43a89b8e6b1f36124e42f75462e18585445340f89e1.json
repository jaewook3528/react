{"ast":null,"code":"import _slicedToArray from\"C:/react/git/react/blog-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import{useDispatch,useSelector}from'react-redux';import{withRouter}from'react-router-dom';import{changeField,initializeForm,login}from'../../modules/auth';import AuthForm from'../../components/auth/AuthForm';import{check}from'../../modules/user';var LoginForm=function LoginForm(_ref){var history=_ref.history;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var dispatch=useDispatch();var _useSelector=useSelector(function(_ref2){var auth=_ref2.auth,user=_ref2.user;return{form:auth.login,auth:auth.auth,authError:auth.authError,user:user.user};}),form=_useSelector.form,auth=_useSelector.auth,authError=_useSelector.authError,user=_useSelector.user;// 인풋 변경 이벤트 핸들러\nvar onChange=function onChange(e){var _e$target=e.target,value=_e$target.value,name=_e$target.name;dispatch(changeField({form:'login',key:name,value:value}));};// 폼 등록 이벤트 핸들러\nvar onSubmit=function onSubmit(e){e.preventDefault();var username=form.username,password=form.password;dispatch(login({username:username,password:password}));};// 컴포넌트가 처음 렌더링될 때 form을 초기화함\nuseEffect(function(){dispatch(initializeForm('login'));},[dispatch]);useEffect(function(){if(authError){console.log('오류 발생');console.log(authError);setError('로그인 실패');return;}if(auth){console.log('로그인 성공');dispatch(check());}},[auth,authError,dispatch]);useEffect(function(){if(user){history.push('/');try{localStorage.setItem('user',JSON.stringify(user));}catch(e){console.log('localStorage is not working');}}},[history,user]);return/*#__PURE__*/React.createElement(AuthForm,{type:\"login\",form:form,onChange:onChange,onSubmit:onSubmit,error:error});};export default withRouter(LoginForm);","map":{"version":3,"names":["React","useEffect","useState","useDispatch","useSelector","withRouter","changeField","initializeForm","login","AuthForm","check","LoginForm","_ref","history","_useState","_useState2","_slicedToArray","error","setError","dispatch","_useSelector","_ref2","auth","user","form","authError","onChange","e","_e$target","target","value","name","key","onSubmit","preventDefault","username","password","console","log","push","localStorage","setItem","JSON","stringify","createElement","type"],"sources":["C:/react/git/react/blog-frontend/src/containers/auth/LoginForm.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { withRouter } from 'react-router-dom';\r\nimport { changeField, initializeForm, login } from '../../modules/auth';\r\nimport AuthForm from '../../components/auth/AuthForm';\r\nimport { check } from '../../modules/user';\r\n\r\nconst LoginForm = ({ history }) => {\r\n  const [error, setError] = useState(null);\r\n  const dispatch = useDispatch();\r\n  const { form, auth, authError, user } = useSelector(({ auth, user }) => ({\r\n    form: auth.login,\r\n    auth: auth.auth,\r\n    authError: auth.authError,\r\n    user: user.user\r\n  }));\r\n  // 인풋 변경 이벤트 핸들러\r\n  const onChange = e => {\r\n    const { value, name } = e.target;\r\n    dispatch(\r\n      changeField({\r\n        form: 'login',\r\n        key: name,\r\n        value\r\n      })\r\n    );\r\n  };\r\n\r\n  // 폼 등록 이벤트 핸들러\r\n  const onSubmit = e => {\r\n    e.preventDefault();\r\n    const { username, password } = form;\r\n    dispatch(login({ username, password }));\r\n  };\r\n\r\n  // 컴포넌트가 처음 렌더링될 때 form을 초기화함\r\n  useEffect(() => {\r\n    dispatch(initializeForm('login'));\r\n  }, [dispatch]);\r\n\r\n  useEffect(() => {\r\n    if (authError) {\r\n      console.log('오류 발생');\r\n      console.log(authError);\r\n      setError('로그인 실패');\r\n      return;\r\n    }\r\n    if (auth) {\r\n      console.log('로그인 성공');\r\n      dispatch(check());\r\n    }\r\n  }, [auth, authError, dispatch]);\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      history.push('/');\r\n      try {\r\n        localStorage.setItem('user', JSON.stringify(user));\r\n      } catch (e) {\r\n        console.log('localStorage is not working');\r\n      }\r\n    }\r\n  }, [history, user]);\r\n\r\n  return (\r\n    <AuthForm\r\n      type=\"login\"\r\n      form={form}\r\n      onChange={onChange}\r\n      onSubmit={onSubmit}\r\n      error={error}\r\n    />\r\n  );\r\n};\r\n\r\nexport default withRouter(LoginForm);"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}