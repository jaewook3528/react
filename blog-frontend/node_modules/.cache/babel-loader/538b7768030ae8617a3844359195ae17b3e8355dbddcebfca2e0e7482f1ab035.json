{"ast":null,"code":"import { createAction, handleActions } from 'redux-actions';\nimport { takeLatest } from 'redux-saga/effects';\nimport * as authAPI from '../lib/api/auth';\nimport createRequestSaga, { createRequestActionTypes } from '../lib/createRequestSaga';\nconst TEMP_SET_USER = 'user/TEMP_SET_USER'; // 새로고침 이후 임시 로그인 처리\n// 회원 정보 확인\nconst [CHECK, CHECK_SUCCESS, CHECK_FAILURE] = createRequestActionTypes('user/CHECK');\nconst LOGOUT = 'user/LOGOUT';\nexport const tempSetUser = createAction(TEMP_SET_USER, user => user);\nexport const check = createAction(CHECK);\nexport const logout = createAction(LOGOUT);\nconst checkSaga = createRequestSaga(CHECK, authAPI.check);\nfunction checkFailureSaga() {\n  try {\n    localStorage.removeItem('user'); // localStorage에서 user를 제거\n  } catch (e) {\n    console.log('localStorage is not working');\n  }\n}\nfunction* logoutSaga() {\n  try {\n    yield call(authAPI.logout); // logout API 호출\n    localStorage.removeItem('user'); // localStorage에서 user를 제거\n  } catch (e) {\n    console.log(e);\n  }\n}\nexport function* userSaga() {\n  yield takeLatest(CHECK, checkSaga);\n  yield takeLatest(CHECK_FAILURE, checkFailureSaga);\n  yield takeLatest(LOGOUT, logoutSaga);\n}\nconst initialState = {\n  user: null,\n  checkError: null\n};\nexport default handleActions({\n  [TEMP_SET_USER]: (state, _ref) => {\n    let {\n      payload: user\n    } = _ref;\n    return {\n      ...state,\n      user\n    };\n  },\n  [CHECK_SUCCESS]: (state, _ref2) => {\n    let {\n      payload: user\n    } = _ref2;\n    return {\n      ...state,\n      user,\n      checkError: null\n    };\n  },\n  [CHECK_FAILURE]: (state, _ref3) => {\n    let {\n      payload: error\n    } = _ref3;\n    return {\n      ...state,\n      user: null,\n      checkError: error\n    };\n  },\n  [LOGOUT]: state => ({\n    ...state,\n    user: null\n  })\n}, initialState);","map":{"version":3,"names":["createAction","handleActions","takeLatest","authAPI","createRequestSaga","createRequestActionTypes","TEMP_SET_USER","CHECK","CHECK_SUCCESS","CHECK_FAILURE","LOGOUT","tempSetUser","user","check","logout","checkSaga","checkFailureSaga","localStorage","removeItem","e","console","log","logoutSaga","call","userSaga","initialState","checkError","state","_ref","payload","_ref2","_ref3","error"],"sources":["C:/react/project/blog-frontend/src/modules/user.js"],"sourcesContent":["import { createAction, handleActions } from 'redux-actions';\r\nimport { takeLatest } from 'redux-saga/effects';\r\nimport * as authAPI from '../lib/api/auth';\r\nimport createRequestSaga, {\r\n  createRequestActionTypes,\r\n} from '../lib/createRequestSaga';\r\n\r\nconst TEMP_SET_USER = 'user/TEMP_SET_USER'; // 새로고침 이후 임시 로그인 처리\r\n// 회원 정보 확인\r\nconst [CHECK, CHECK_SUCCESS, CHECK_FAILURE] = createRequestActionTypes(\r\n  'user/CHECK',\r\n);\r\nconst LOGOUT = 'user/LOGOUT';\r\n\r\nexport const tempSetUser = createAction(TEMP_SET_USER, user => user);\r\nexport const check = createAction(CHECK);\r\nexport const logout = createAction(LOGOUT);\r\n\r\nconst checkSaga = createRequestSaga(CHECK, authAPI.check);\r\n\r\nfunction checkFailureSaga() {\r\n  try {\r\n    localStorage.removeItem('user'); // localStorage에서 user를 제거\r\n  } catch (e) {\r\n    console.log('localStorage is not working');\r\n  }\r\n}\r\n\r\nfunction* logoutSaga() {\r\n    try {\r\n      yield call(authAPI.logout); // logout API 호출\r\n      localStorage.removeItem('user'); // localStorage에서 user를 제거\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n}\r\n\r\nexport function* userSaga() {\r\n    yield takeLatest(CHECK, checkSaga);\r\n    yield takeLatest(CHECK_FAILURE, checkFailureSaga);\r\n    yield takeLatest(LOGOUT, logoutSaga);\r\n}\r\n\r\nconst initialState = {\r\n  user: null,\r\n  checkError: null,\r\n};\r\n\r\nexport default handleActions(\r\n  {\r\n    [TEMP_SET_USER]: (state, { payload: user }) => ({\r\n      ...state,\r\n      user,\r\n    }),\r\n    [CHECK_SUCCESS]: (state, { payload: user }) => ({\r\n      ...state,\r\n      user,\r\n      checkError: null,\r\n    }),\r\n    [CHECK_FAILURE]: (state, { payload: error }) => ({\r\n      ...state,\r\n      user: null,\r\n      checkError: error,\r\n    }),\r\n    [LOGOUT]: state => ({\r\n        ...state,\r\n        user: null,\r\n      }),\r\n  },\r\n  initialState,\r\n);"],"mappings":"AAAA,SAASA,YAAY,EAAEC,aAAa,QAAQ,eAAe;AAC3D,SAASC,UAAU,QAAQ,oBAAoB;AAC/C,OAAO,KAAKC,OAAO,MAAM,iBAAiB;AAC1C,OAAOC,iBAAiB,IACtBC,wBAAwB,QACnB,0BAA0B;AAEjC,MAAMC,aAAa,GAAG,oBAAoB,CAAC,CAAC;AAC5C;AACA,MAAM,CAACC,KAAK,EAAEC,aAAa,EAAEC,aAAa,CAAC,GAAGJ,wBAAwB,CACpE,YAAY,CACb;AACD,MAAMK,MAAM,GAAG,aAAa;AAE5B,OAAO,MAAMC,WAAW,GAAGX,YAAY,CAACM,aAAa,EAAEM,IAAI,IAAIA,IAAI,CAAC;AACpE,OAAO,MAAMC,KAAK,GAAGb,YAAY,CAACO,KAAK,CAAC;AACxC,OAAO,MAAMO,MAAM,GAAGd,YAAY,CAACU,MAAM,CAAC;AAE1C,MAAMK,SAAS,GAAGX,iBAAiB,CAACG,KAAK,EAAEJ,OAAO,CAACU,KAAK,CAAC;AAEzD,SAASG,gBAAgBA,CAAA,EAAG;EAC1B,IAAI;IACFC,YAAY,CAACC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC;EACnC,CAAC,CAAC,OAAOC,CAAC,EAAE;IACVC,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAC;EAC5C;AACF;AAEA,UAAUC,UAAUA,CAAA,EAAG;EACnB,IAAI;IACF,MAAMC,IAAI,CAACpB,OAAO,CAACW,MAAM,CAAC,CAAC,CAAC;IAC5BG,YAAY,CAACC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC;EACnC,CAAC,CAAC,OAAOC,CAAC,EAAE;IACVC,OAAO,CAACC,GAAG,CAACF,CAAC,CAAC;EAChB;AACJ;AAEA,OAAO,UAAUK,QAAQA,CAAA,EAAG;EACxB,MAAMtB,UAAU,CAACK,KAAK,EAAEQ,SAAS,CAAC;EAClC,MAAMb,UAAU,CAACO,aAAa,EAAEO,gBAAgB,CAAC;EACjD,MAAMd,UAAU,CAACQ,MAAM,EAAEY,UAAU,CAAC;AACxC;AAEA,MAAMG,YAAY,GAAG;EACnBb,IAAI,EAAE,IAAI;EACVc,UAAU,EAAE;AACd,CAAC;AAED,eAAezB,aAAa,CAC1B;EACE,CAACK,aAAa,GAAG,CAACqB,KAAK,EAAAC,IAAA;IAAA,IAAE;MAAEC,OAAO,EAAEjB;IAAK,CAAC,GAAAgB,IAAA;IAAA,OAAM;MAC9C,GAAGD,KAAK;MACRf;IACF,CAAC;EAAA,CAAC;EACF,CAACJ,aAAa,GAAG,CAACmB,KAAK,EAAAG,KAAA;IAAA,IAAE;MAAED,OAAO,EAAEjB;IAAK,CAAC,GAAAkB,KAAA;IAAA,OAAM;MAC9C,GAAGH,KAAK;MACRf,IAAI;MACJc,UAAU,EAAE;IACd,CAAC;EAAA,CAAC;EACF,CAACjB,aAAa,GAAG,CAACkB,KAAK,EAAAI,KAAA;IAAA,IAAE;MAAEF,OAAO,EAAEG;IAAM,CAAC,GAAAD,KAAA;IAAA,OAAM;MAC/C,GAAGJ,KAAK;MACRf,IAAI,EAAE,IAAI;MACVc,UAAU,EAAEM;IACd,CAAC;EAAA,CAAC;EACF,CAACtB,MAAM,GAAGiB,KAAK,KAAK;IAChB,GAAGA,KAAK;IACRf,IAAI,EAAE;EACR,CAAC;AACL,CAAC,EACDa,YAAY,CACb"},"metadata":{},"sourceType":"module","externalDependencies":[]}